sap.ui.define([                                                                                                                                                                                                                                                
	"sap/ui/core/mvc/Controller"                                                                                                                                                                                                                                  
], function (Controller) {                                                                                                                                                                                                                                     
	"use strict";                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
	return Controller.extend("ZINFRA_MRS_PLANNING_BOARD.ZINFRA_MRS_PLANNING_BOARD.controller.SelectionView", {                                                                                                                                                    
                                                                                                                                                                                                                                                               
		oDateFormat: null,                                                                                                                                                                                                                                           
		onInit: function () {                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			this.oDateFormat = sap.ui.core.format.DateFormat.getInstance({                                                                                                                                                                                              
				pattern: "yyyy-MM-dd",                                                                                                                                                                                                                                     
				calendarType: sap.ui.core.CalendarType.Gregorian                                                                                                                                                                                                           
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			var oSelModel = new sap.ui.model.json.JSONModel({                                                                                                                                                                                                           
				"selDateFrom": null,                                                                                                                                                                                                                                       
				"selDateTo": null,                                                                                                                                                                                                                                         
				"idWorkCenter": [],                                                                                                                                                                                                                                        
				"idPerson": [],                                                                                                                                                                                                                                            
				"idNNResource": [],                                                                                                                                                                                                                                        
				"idTimeAllocType": []                                                                                                                                                                                                                                      
			});                                                                                                                                                                                                                                                         
			this.getView().setModel(oSelModel, "selModel");                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onBeforeRendering: function () {                                                                                                                                                                                                                             
			// //Value help and Tokenizing                                                                                                                                                                                                                              
			this.getView().byId("idWorkCenter").setModel(this.getView().getModel("DataProvider"));                                                                                                                                                                      
			this.getView().byId("idPerson").setModel(this.getView().getModel("DataProvider"));                                                                                                                                                                          
			this.getView().byId("idNNResource").setModel(this.getView().getModel("DataProvider"));                                                                                                                                                                      
			this.getView().byId("idTimeAllocType").setModel(this.getView().getModel("DataProvider"));                                                                                                                                                                   
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		//Set Selected dates/weeks                                                                                                                                                                                                                                   
		handleCalendarSelect: function (oEvtCal) {                                                                                                                                                                                                                   
			this.getView().getModel("selModel").setProperty("/selDateFrom", null);                                                                                                                                                                                      
			this.getView().getModel("selModel").setProperty("/selDateTo", null);                                                                                                                                                                                        
			var oselDateFrom = new Date(oEvtCal.getSource().getSelectedDates()[0].getStartDate());                                                                                                                                                                      
			this.getView().getModel("selModel").setProperty("/selDateFrom", this.oDateFormat.format(oselDateFrom));                                                                                                                                                     
			if (oEvtCal.getSource().getSelectedDates()[0].getEndDate()) {                                                                                                                                                                                               
				var oselDateTo = new Date(oEvtCal.getSource().getSelectedDates()[0].getEndDate());                                                                                                                                                                         
				this.getView().getModel("selModel").setProperty("/selDateTo", this.oDateFormat.format(oselDateTo));                                                                                                                                                        
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onDashBoardClick: function (oEvtDashBrd) {                                                                                                                                                                                                                   
			//Get Tokens from Filters                                                                                                                                                                                                                                   
			this.byId("idWorkCenter").getTokens().forEach(function (oToken) {                                                                                                                                                                                           
				oToken.getParent().getModel("selModel").getData().idWorkCenter.push(oToken.getText());                                                                                                                                                                     
			});                                                                                                                                                                                                                                                         
			this.byId("idPerson").getTokens().forEach(function (oToken) {                                                                                                                                                                                               
				oToken.getParent().getModel("selModel").getData().idPerson.push(oToken.getText());                                                                                                                                                                         
			});                                                                                                                                                                                                                                                         
			this.byId("idNNResource").getTokens().forEach(function (oToken) {                                                                                                                                                                                           
				oToken.getParent().getModel("selModel").getData().idNNResource.push(oToken.getText());                                                                                                                                                                     
			});                                                                                                                                                                                                                                                         
			this.byId("idTimeAllocType").getTokens().forEach(function (oToken) {                                                                                                                                                                                        
				oToken.getParent().getModel("selModel").getData().idTimeAllocType.push(oToken.getText());                                                                                                                                                                  
			});                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
			//Navigate to Relevant View                                                                                                                                                                                                                                 
			var sRoute = this.byId("rbDailyView").getSelected() ? "toDailyView" : "toResourceView";                                                                                                                                                                     
			this.getOwnerComponent().getRouter().navTo(sRoute, {                                                                                                                                                                                                        
				selModel: JSON.stringify(this.getView().getModel("selModel").getData())                                                                                                                                                                                    
			}, true);                                                                                                                                                                                                                                                   
		}                                                                                                                                                                                                                                                            
	});                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
});                                                                                                                                                                                                                                                            